define(["dojo/on","dojo/dom-construct","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/request","esri/symbols/SimpleMarkerSymbol","esri/widgets/Expand","esri/Graphic","esri/tasks/QueryTask","esri/Color","esri/geometry/geometryEngine","esri/renderers/UniqueValueRenderer","esri/geometry/Extent","esri/Map","esri/tasks/support/Query","esri/widgets/Search","esri/widgets/Legend","esri/widgets/LayerList","esri/widgets/Locate","esri/layers/WebTileLayer","esri/layers/FeatureLayer","esri/layers/MapImageLayer","esri/layers/OpenStreetMapLayer","esri/tasks/Locator","esri/layers/GraphicsLayer","dojo/window","dojo/dom","dojo/dom-class","esri/core/watchUtils","esri/core/Collection","esri/geometry/Polygon","esri/geometry/Polyline","esri/widgets/Locate/LocateViewModel","dojo/dom-style","esri/views/MapView","dojo/sniff"],function(e,t,n,o,r,i,s,a,c,u,l,p,d,f,y,v,m,h,w,g,x,b,T,E,S,j,k,L,P,C,H,M,I,N,O,V){return function(e){function t(t){for(var n,r,i=t[0],s=t[1],a=0,u=[];a<i.length;a++)r=i[a],o[r]&&u.push(o[r][0]),o[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);u.length;)u.shift()()}var n={},o={3:0};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise(function(t,r){n=o[e]=[t,r]});t.push(n[2]=i);var s=document.getElementsByTagName("head")[0],a=document.createElement("script");a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.src=function(e){return r.p+""+({}[e]||e)+".bundle.js"}(e);var c=setTimeout(function(){u({type:"timeout",target:a})},12e4);function u(t){a.onerror=a.onload=null,clearTimeout(c);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+r+": "+i+")");s.type=r,s.request=i,n[1](s)}o[e]=void 0}}a.onerror=a.onload=u,s.appendChild(a)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var a=0;a<i.length;a++)t(i[a]);var c=s;return r(r.s=62)}([function(t,n){t.exports=e},function(e,n){e.exports=t},,function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t){e.exports=s},function(e,t){e.exports=a},function(e,t){e.exports=c},function(e,t){e.exports=u},,function(e,t){e.exports=l},function(e,t){e.exports=p},function(e,t){e.exports=d},function(e,t){e.exports=f},function(e,t){e.exports=y},function(e,t){e.exports=v},function(e,t){e.exports=m},function(e,t){e.exports=h},function(e,t){e.exports=w},function(e,t){e.exports=g},function(e,t){e.exports=x},function(e,t){e.exports=b},function(e,t){e.exports=T},function(e,t){e.exports=E},,,function(e,t){e.exports=S},function(e,t){e.exports=j},,function(e,t){e.exports=k},function(e,t){e.exports=L},,,function(e,t){e.exports=P},function(e,t){e.exports=C},function(e,t){e.exports=H},function(e,t){e.exports=M},function(e,t){e.exports=I},,,function(e,t){e.exports=N},function(e,t){e.exports=O},,function(e,t){e.exports=V},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.e(0).then(function(){var e=[n(2),n(11),n(15),n(25),n(44),n(24),n(23),n(22),n(21),n(7),n(20),n(19),n(18),n(17),n(9),n(16),n(5),n(13),n(6),n(30),n(41),n(40),n(4),n(3),n(14),n(0),n(1),n(45)];(function(e,t,n,o,r,i,s,a,c,u,l,p,d,f,y,v,m,h,w,g,x,b,T,E,S,j,k,L){var P,C,H,M=new g,I=new n({}),N=new r({container:"map",map:I,center:t.center,zoom:t.zoom});N.session().then(function(n){M.user=n;var o=void 0;7===Math.floor(M.user.role/100)&&(o="MaHuyenTP = '"+M.user.role.trim()+"'"),N.systemVariable=M;var r=function(){var e,t,n,o,r;e=$("<div/>",{class:"google-geocoding-widget input-group add-on"}),t=$("<input/>",{class:"form-control",type:"text",name:"srch-term",id:"srch-term",placeholder:"Nhập đơn vị hành chính, tên đường "}).appendTo(e),n=$("<div/>",{class:"input-group-btn"}).appendTo(e),o=$("<button/>",{class:"btn btn-default",type:"submit"}).appendTo(n),$("<i/>",{class:"glyphicon glyphicon-search"}).appendTo(o),r=$("<div/>",{class:"output-group add-on",id:"ketqua"}),N.ui.add(e[0],"top-left"),N.ui.add(r[0],"top-left"),o.on("click",function(e){function n(){var e=document.getElementById("ketqua");if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}var o=t.val().toString().replace(/[ ]/g,"+");$.get("https://maps.googleapis.com/maps/api/geocode/json?address="+o+"&key=AIzaSyC9VTEqoczK2j7lDRacfQ3aRTE3f4vuHek").done(function(e){var t=e.results;n();var o=function(e){var t=$("<div />",{class:"address list-group-item"}).appendTo(r);$("<div />",{class:"address-detail",text:e.formatted_address}).appendTo(t).click(function(){return t=e.geometry.viewport,o=new S({ymin:t.southwest.lat,ymax:t.northeast.lat,xmin:t.southwest.lng,xmax:t.northeast.lng}),N.goTo(o),void n();var t,o})},i=!0,s=!1,a=void 0;try{for(var c,u=t[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)o(c.value)}catch(e){s=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(s)throw a}}})}),new x(N).startup(),N.ui.move(["zoom"],"top-left"),N.ui.add(new u({expandIconClass:"esri-icon-layer-list",view:N,content:new p({container:document.createElement("div"),view:N})}),"top-left"),N.ui.add(new l({view:N}),"top-left"),N.ui.add(new u({expandIconClass:"esri-icon-collection",content:new d({view:N})}),"top-left"),new b(N).startup()};!function(){var n=t.basemap;if(o){var r=!0,i=!1,a=void 0;try{for(var u,l=n.sublayers[Symbol.iterator]();!(r=(u=l.next()).done);r=!0)u.value.definitionExpression=o}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}function p(e,t,n,o){if(e)switch(o){case H:P.visible=C.visible=!e;break;case P:H.visible=C.visible=!e;break;case C:H.visible=P.visible=!e}}n.visible=!1,(P=new s(n)).watch("visible",function(e){$&&$.notify(e?"Hiển thị dữ liệu nền":"Ẩn dữ liệu nền")}),P.then(function(){if(o){var t=P.findSublayerById(e.INDEX_HANHCHINHHUYEN),n=t.createQuery();n.where=o,n.returnGeometry=!0,n.outSpatialReference=N.spatialReference,t.queryFeatures(n).then(function(e){var t=e.features[0];N.goTo({target:t.geometry})})}}),C=new c({urlTemplate:"//mt1.google.com/vt/lyrs=y&x={col}&y={row}&z={level}",title:"Ảnh vệ tinh",id:"worldimagery",visible:!0}),H=new c({title:"Đường đi",urlTemplate:"//mt1.google.com/vt/lyrs=m&x={col}&y={row}&z={level}",id:"osm",visible:!1}),I.addMany([H,C,P]),H.watch("visible",p),C.watch("visible",p),P.watch("visible",p)}(),(a.prototype.getAttachments=function(e){var t=this;return new Promise(function(n,o){var r=t.url+"/"+t.layerId+"/"+e;m(r+"/attachments?f=json",{responseType:"json",method:"get"}).then(function(e){n(e.data||null)})})},new Promise(function(n,r){m("/map/layerrole",{method:"post"}).then(function(r){if(!r.data)throw"cannot request permission";var i=function(e){t.layers.find(function(t){return t.id===e.layer}).permission={create:e.isCreate,view:e.isView,delete:e.false,edit:e.false}},s=!0,c=!1,u=void 0;try{for(var l,p=r.data[Symbol.iterator]();!(s=(l=p.next()).done);s=!0)i(l.value)}catch(e){c=!0,u=e}finally{try{!s&&p.return&&p.return()}finally{if(c)throw u}}for(var d in t.layers){var f=t.layers[d];if(f.permission.view){if(f.id===e.SAUBENH||f.id===e.DOANHNGHIEP)continue;o&&(f.definitionExpression?f.definitionExpression+=" and "+o:f.definitionExpression=o,f.definitionExpression=o),f.id===e.TRONGTROT&&(f.opacity=.7);var y=new a(f);I.add(y)}}var v=new a({id:"danhdauvitri",title:"Vị trí đánh dấu",outFields:["*"],url:"https://ditagis.com:6443/arcgis/rest/services/BinhDuong/BaoVeThucVat_DanhDauViTri/FeatureServer/0",permission:{create:!1,view:!0,delete:!0,edit:!0}});I.add(v),n()})})).then(function(){r(),I.reorder(P,5)})})}).apply(null,e)}).catch(n.oe)}])});