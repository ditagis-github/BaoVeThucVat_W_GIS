{"version":3,"file":"HightlightGraphic.js","sourceRoot":"","sources":["HightlightGraphic.ts"],"names":[],"mappings":"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","sourcesContent":["import Graphic = require(\"esri/Graphic\");\r\nimport SimpleMarkerSymbol = require(\"esri/symbols/SimpleMarkerSymbol\");\r\nimport SimpleLineSymbol = require(\"esri/symbols/SimpleLineSymbol\");\r\nimport SimpleFillSymbol = require(\"esri/symbols/SimpleFillSymbol\");\r\nimport View = require('esri/views/MapView');\r\nimport Color = require('esri/Color');\r\nclass HightlightGraphic {\r\n  view: View;\r\n  symbolMarker: SimpleMarkerSymbol;\r\n  symbolLine: SimpleLineSymbol;\r\n  symbolPlg: SimpleFillSymbol;\r\n  tmpGraphics: Array<Graphic>;\r\n  constructor(view: View, options) {\r\n    options = options || {};\r\n    this.view = view;\r\n    this.symbolMarker = options.symbolMarker || new SimpleMarkerSymbol({\r\n      color: new Color([255, 0, 0]),\r\n      size: 3,\r\n      outline: new SimpleLineSymbol({\r\n        width: 7,\r\n        color: new Color([255, 64, 0, 0.4])\r\n      })\r\n    })\r\n\r\n    this.symbolLine = options.symbolLine || new SimpleLineSymbol({\r\n      color: new Color([255, 0, 0]),\r\n      width: 4\r\n    })\r\n    this.symbolPlg = options.symbolPlg || {\r\n      type: 'simple-polygon',\r\n      color: [255, 0, 0],\r\n      size: 3,\r\n      width: 4,\r\n      outline: { // autocasts as new SimpleLineSymbol()\r\n        color: [255, 64, 0, 0.4], // autocasts as new Color()\r\n        width: 7\r\n      }\r\n    }\r\n    this.tmpGraphics = [];\r\n  }\r\n  /**\r\n   * Làm sáng các graphic được tìm thấy xung quanh screenCoor\r\n   * @param {ScreenCoor{x,y}} screenCoors \r\n   */\r\n  hightlight(screenCoors): void {\r\n    this.clear(); //xóa cái hightlight hiện có\r\n    //tìm những graphic có ở tọa độ screenCoors\r\n    this.view.hitTest(screenCoors).then((res) => {\r\n      //duyệt kết quả\r\n      for (let result of res.results) {\r\n        const graphic = result.graphic; //lấy graphic\r\n        //kiểm tra xem có attributes hay không\r\n        //nếu không có nghĩa là graphic này không được sinh ra từ FeatureLayer services\r\n        if (graphic.attributes && graphic.attributes != null) {\r\n          this.add(graphic);\r\n        }\r\n      }\r\n      //nếu như có graphic cần hightlight thì gọi renderer\r\n    })\r\n  }\r\n  /**\r\n   * Trên bản đồ chỉ được hightlight duy nhất một vùng nên \r\n   * cần phải có phương thức này để xóa các hightlight của những layer khác\r\n   * vì giải thuật này hightlight theo UniqueValuaRenderer \r\n   * nên sẽ có tình trạng những layer khác nhau được hightligt thì sẽ không bị ẩn đi\r\n   * có thể xóa dùng this.clear() ở phương thức hightlight để nhìn nhận rõ ràng hơn\r\n   */\r\n  clear() {\r\n    this.removeAll();\r\n  }\r\n  rendererGraphic(type, geometry) {\r\n    let symbol;\r\n\r\n    if (type === 'point') {\r\n      symbol = this.symbolMarker;\r\n    } else if (type === 'polyline') {\r\n      symbol = this.symbolLine;\r\n    } else {\r\n      symbol = this.symbolPlg;\r\n    }\r\n    let graphic = new Graphic({\r\n      geometry: geometry,\r\n      symbol: symbol\r\n    });\r\n    return graphic;\r\n  }\r\n  add(graphic) {\r\n    const type = graphic.layer.geometryType;\r\n    let renderergraphic = this.rendererGraphic(type, graphic.geometry);\r\n    this.tmpGraphics.push(renderergraphic);\r\n    this.view.graphics.add(renderergraphic);\r\n  }\r\n  addAll(graphics) {\r\n    for (let g of graphics) {\r\n      this.add(g);\r\n    }\r\n  }\r\n  removeAll() {\r\n    for (let g of this.tmpGraphics) {\r\n      this.view.graphics.remove(g);\r\n    }\r\n    this.tmpGraphics = [];\r\n  }\r\n}\r\nexport = HightlightGraphic;"]}